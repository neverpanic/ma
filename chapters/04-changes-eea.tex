% vim:noet:sts=2:ts=2:sw=2:smarttab:tw=120

\chapter{Adjustments in Escape Analysis}
	\label{chapter:changes-eea}
	Reference the algorithm outlined by Choi et al.\@ in 2003, explain the changes I implemented for my master's thesis,
	why they were required or beneficial and how they were implemented.

	\section{Flow-Sensitive Escape Analysis}
		\label{sec:changes-eea:flow-sensitive}
		Explain what Choi et al.\@ meant by \enquote{we kill only local variables} and how the \texttt{transfer} and
		\texttt{meet} functions are implemented in JINO to achieve flow sensitivity of the escape analysis.

	\section{Fixing Incorrect Results of Choi's Original Algorithm}
		\label{sec:changes-eea:bug}
		Show that \texttt{Object chooseOne(Object a, Object b)} is not correctly handled by Choi's algorithm if the return
		value of this function is itself returned again. Show what I have done to improve that.

	\section{Optimizations for Speedup}
		\label{sec:changes-eea:opt}
		The work I did in my bachelor's thesis did take rather long especially on large examples. I have implemented a few
		optimizations to make it run faster. These are:
		
		\subsection{Propagate Only Writes}
			\label{sub:changes-eea:opt:writeonly}
			Ignore read operations and propagate only writes. Explain how that has the potential of cutting down lots of nodes
			generated by vcalls to \texttt{equals(Object other)} (and why that does not work in the implementation we use).

		\subsection{Only Process Methods With Changed Callees}
			\label{sub:changes-eea:opt:quick-fixpoint}
			When iterating to find a fixpoint in a strongly connected component, only re-compute the summary information for
			a method if its callees actually changed; re-use the old results otherwise.

		\subsection{Compress the Connection Graph}
			\label{sub:changes-eea:opt:compression}
			Compress multiple sibling nodes if they likely represent the same node. This gives us a huge speedup without
			giving up too much information (explain how I made sure the relevant information is kept).
